---
typora-root-url: E:\markdown笔记\笔记图片
---

# Java 设计模式

这门课所要学的东西：

![11-1](/11-1.png)

![11-2](/11-2.png)

![11-3](/11-3.png)

![11-5](/11-5.png)

## 第一章 UML入门

![11-4](/11-6.png)

### 1、UML简单入门

* UML定义

  * 统一建模语言(Unified Modeling Language，缩写UML)
  * 非专利的第三代建模和规约语言

* UML特点：

  * UML是一种开放的方法
  * 用于说明、可视化、构建和编写一个正在开发的面向对象的、软件密集系统的制品的开放方法。其中制品指的是在软件开发过程中产生的各种各样的产物，如模型、流程图、源代码和测试用例等。
  * UML展现了一系列最佳工程实践，这些最佳实践在对大规模，复杂系统进行建模方面，特别是在冉家架构层次已经被验证有效。

* UML2.2分类

  UML2.2中一共定义了14种图示，分类如下：

  * 结构式图形：强调的是系统式的建模
  * 行为式图形：强调系统模型中触发的事件
  * 交互式图形：属于行为式图形子集合，强调系统建模中资料流程

* 结构式图形

  * 静态图（类图，对象图，包图）
  * 实现图（组件图，部署图）
  * 剖面图
  * 复合结构图

* 行为式图形

  * 活动图
  * 状态图
  * 用例图

* 交互式图形

  * 通信图
  * 交互概述图（UML2.0）
  * 时序图（UML2.0）
  * 时间图（UML2.0）

* UML类图

  * Class Diagram：用于表示类、接口、实例等之间相互的静态关系
  * 虽然名字叫类图，但类图中不只有类

* 记忆技巧

  * UML件箭头方向：从子类指向父类；从实现类指向接口。实线是继承；虚线是实现。空心三角箭头：继承或实现

    **提示**：可能会认为子类是以父类为基础的，箭头应从父类指向子类

  * 实线是关联关系，虚线是依赖关系。虚线一般是一个类使用另一个类作为参数使用，或作为返回值，其中箭头指向被依赖的对象。；实线通常是一个类中有另一个类对象作为属性，其中箭头指向被关联对象。

  * 空心菱形表聚合， 实心菱形表组合。

    ![11-8](/11-8.png)

    ![11-7](/11-7.png)

    实心菱形表组合：

    - 整体和局部的关系，和聚合的关系相比，关系更加强烈。两周有相同的生命周期，contains-a的关系
    - 两者之间是强关系(实心)
    - 其中菱形在数目少的那一边，比如上面的种情况。一只鸟有两只翅膀，菱形就在鸟的那边

    空心菱形表聚合：

    * 整体和局部的关系，两者有着独立的生命周期，是has a的关系
    * 两者之间是弱关系(空心)
    * 其中菱形在数目多的那一边，比如上面的种情况。大雁群和大雁，菱形就在大雁群那边

    ![11-9](/11-9.png)

* UML时序图

  * Sequence Diagam：是显示对象之间交互的图，这些对象是按时间顺序排列的。
  * 时序图中包括的建模元素主要有：对象(Actor)、生命线(Lifeline)、控制焦点(Focus of control)、消息(Meaasge)等

  ![11-10](/11-10.png)

### 2、UML类图讲解

![11-11](/11-11.png)

上图中有三部分，第一部分是类名，第二部分是类的属性，第三部分是类的方法。

其中就其属性来讲：

* `+`说明是public
* `-`说明是private
* `#`说明是protected
* `~`说明是default，包权限
* `String,char,int,double`这些是类型
* `下划线`说明是个static属性

其中就其方法来说，除了访问限制符：

* `斜体方法`表明是一个抽象方法
* `boolean`表明的是返回值类型

### 3、UML类图讲解-自上而下 

![11-12](/11-12.png)

下面我们将对上图进行分析：

* 对于**动物**来说：属性是**生命**，方法是**新陈代谢**，依赖**氧气、水**
* 对于**鸟**来说：继承自**动物**，箭头指向**动物**，鸟可以强转为**动物**，但是动物强转为鸟却不一定了；鸟和翅膀是组合关系，有相同的生命周期，其中1,2表示1只鸟有两个翅膀
* 对于**企鹅**来说：继承自**鸟**，与**气候**是关联关系
* 对于**大雁**来说：继承自**鸟**，与**大雁群**是聚合关系，大雁群has a 大雁，箭头指向个体；实现了**飞翔**接口
* 对于**唐老鸭**来说：继承自**鸭**，实现了**讲人话**接口

## 第二章 设计原则

* 开闭原则
* 依赖倒置原则
* 单一职责原则
* 接口隔离原则
* 迪米特法则（最少知道原则）
* 里氏替换原则
* 合成/复用原则（组合/复用原则)

设计原则的使用不是必须要遵守的，我是要有度，掌握平衡

### 1、开闭原则（基础）

* 定义：一个软件实体如类、模块和函数应该对扩展开放，对修改关闭
* 用抽象构建框架，用实现扩展细节
* 优点：提高软件系统的可复用性和可维护性

关于开闭原则的Coding部分请参考：cn.bravedawn.design_pattern.openclose

![11-13](/11-13.png)

首先我创建了一个接口ICourse，然后我用基类JavaCourse实现了ICourse接口。此时我有一个需求，需要设置一个课程的活动价格，那我们该怎么做呢？

* 法一：在接口里面添加一个getDiscountPrice的方法，然后让JavaCourse去实现这个方法

* 法二：在JavaCourse类里添加下列代码：

  ```java
  public Double getDiscountPrice(){
  	return this.price*0.8;
  }
  ```

* 法三：创建一个JavaDiscountCourse类，继承自JavaCourse然后编写代码：

  ```java
  public class JavaDiscountCourse extends JavaCourse {
  
      public JavaDiscountCourse(Integer id, String name, Double price) {
              super(id, name, price);
      }
  
      public Double getOriginPrice(){
          return super.getPrice();
      }
  
      @Override
      public Double getPrice() {
          return super.getPrice()*0.8;
      }
  }
  ```

  这样我们就可以在**不改变接口和基类的情况下**去做业务的拓展了。

* 

