# 3.分布式文件系统-FastDFS+阿里OSS

## 第一章

### 1-1 本章概述

* 概述
  * 分布式文件系统
  * 搭建FastDFS文件服务器
  * 整合第三方文件存储系统

* 目前文件上传的问题

  * 单向储存

  * 不支持集群

  * 文件数据冗余

  * 可扩展性差

* 目前的文件上传架构如下

  ![](../../../笔记图片/20/3-3/1.jpg)

  文件上传之后会存存储在一台tomcat上，在文件读取时，若将请求打到Tomcat1上，则正常获取；若打到Tomcat2或是Tomcat3上，则无法正常获取到文件数据。

  若是在文件上传时，将文件传输到分布式文件服务器。若在读取时，三个Tomcat则都可以访问到这个文件服务器获取文件数据。这样就可以解决单一的文件存储问题，同时他也支持集群、扩容等功能。
  
* 什么是分布式文件系统

  * 随着文件数据的越来越多，通过tomcat或nginx虚拟化的静态资源文件在单一的一个服务器节点内是存不下的，如果用多个节点来存储也是不利于管理和维护，所以我们需要一个系统来管理多台计算机节点上的文件数据，这就是分布式文件系统。
  
  * 分布式文件系统是一个允许文件通过网络在多台节点上分享的文件系统，多台计算机节点共同组成一个整体，为更多的用户提供分享文件。比如常见的网盘，本质就是一个分布式的文件存储系统。虽然我们是一个分布式的文件系统，但是对用户来说是透明的，用户使用像是访问本地磁盘一样。
  
  * 分布式文件系统可以提供冗余备份，所以容错能力很高。 系统中有某些节点宕机，但是整体文件服务不会停止，还是能够为用户提供服务还是运作的，数据也不会丢失。
  
  * 分布式文件系统的可扩展性强，增加或减少节点都很简单，不会影响线上服务，增加完毕后会发布到线上，加入到集群中为用户提供服务。
  * 分布式文件系统可以提供负载均衡能力，在读取文件副本的时候可以由多个节点共同提供服务，而且可以通过横向扩展来确保性能的提高。
  
* 为什么要使用分布式文件系统

  使用分布式文件系统可以解决如下几点问题：
  1. 海量文件数据存储

  2. 文件数据高可用(冗余备份)

  3. 读写性能和负载均衡
    以上3点都是我们之前使用tomcat或nginx所不能够实现的，这也是我们为什么要使用分布式文件系统的原因

* FastDFS 与 HDFS

  说到分布式文件存储，肯定会有人想到HDFS，他们两者主要定位和应用场景是不一样的。

  1. Hadoop中的文件系统HDFS主要解决并行计算中分布式存储数据的问题。其单个数据文件通常很大，采用了分块（切分）存储的方式数据大文件存储来使用的场景。
  2. FastDFS主要用于互联网网站，为文件上传和下载提供在线服务。所以在负载均衡、动态扩容等方面都支持得比较好，FastDFS不会对快存储。FastDFS用于存储中小文件都是不错的，比如用户头像啊，一些较小的音视频文件啊等等都行。

### 1-3 fastdfs概念梳理

FastDFS的相关内容可以参考如下网站：

* 百度百科：https://baike.baidu.com/item/fastdfs/5609710?fr=aladdin
* 开源中国：https://www.oschina.net/p/fastdfs?hmsr=aladdin1e1
* Github：https://github.com/happyfish100/fastdfs




